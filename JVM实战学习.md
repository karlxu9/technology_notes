JVM

Java文件打包编译成class文件

class文件运行，启动一个jvm进程

JVM有一个**类加载器**加载class类，供后续代码运行

JVM基于**字节码执行引擎**，执行内存中的类

<img src="C:\Users\EDZ\AppData\Roaming\Typora\typora-user-images\image-20211112161625805.png" alt="image-20211112161625805" style="zoom: 50%;" />

类加载过程：加载（将class加载进jvm内存）、验证（是否符合jvm规范）、准备（分配空间，初始化值）、解析、初始化

再初始化类之前，发现父类还未初始化，则需要先加载初始化父类

类加载器有几种

启动类加载器、扩展类加载器、程序加载器、自定义加载器

加载顺序从程序->扩展->启动，如果启动类加载器找不到需要加载的类，然后逆序往下找，找到后就加载进内存

这样做的原因是防止类重复加载

如何防止class被反编译？

加密字节码文件，做混淆。然后使用自定义类加载器对加密字节码文件解密，然后加载就可以

JVM内存模型

类加载后到**方法区**，通过**程序计数器**记录当前线程的字节码指令执行到多少行，不同线程会有自己的程序计数器

**虚拟机栈**用来执行对应方法，每个方法对应一个栈帧，栈帧中保存着局部变量表、操作数栈、动态链接、方法出口等

**堆内存**，存放创建的对象